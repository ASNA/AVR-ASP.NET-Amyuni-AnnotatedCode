<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>PrintTest.vr</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>PrintTest.vr</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>This class illustrates a example pattern for printing
to an ASNA DataGate printfile. While it has a few specific
elements that also enable it to print to a PDF print
driver (<a href="https://www.amyuni.com/en/server/appserver/">the Amyuni PDF driver</a>,
in this case), it can also be used to print to standard printers.</p>
<hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kr">Using</span> <span class="nx">System</span>
<span class="kr">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Text</span>
<span class="kr">Using</span> <span class="nx">System</span><span class="p">.</span><span class="nx">IO</span>

<span class="kr">BegClass</span> <span class="nx">PrintTest</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h2>Mainline code</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">DclDB</span> <span class="nx">pgmDB</span>   <span class="nx">DBName</span><span class="p">(</span><span class="s2">&quot;*Public/Cypress&quot;</span><span class="p">)</span>
    <span class="kr">DclDB</span> <span class="nx">prntDB</span>  <span class="nx">DBName</span><span class="p">(</span><span class="s2">&quot;*Public/Cypress&quot;</span><span class="p">)</span>

    <span class="kr">DclDiskFile</span>  <span class="nx">Cust</span> <span class="o">+</span>
        <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Input</span><span class="p">)</span>  <span class="o">+</span>
        <span class="nx">Org</span><span class="p">(</span><span class="o">*</span><span class="nx">Indexed</span><span class="p">)</span> <span class="o">+</span>
        <span class="nx">Prefix</span><span class="p">(</span><span class="nx">Cust_</span><span class="p">)</span> <span class="o">+</span>
        <span class="nx">File</span><span class="p">(</span><span class="s2">&quot;Examples/CMastNewL2&quot;</span><span class="p">)</span> <span class="o">+</span>
        <span class="nx">DB</span><span class="p">(</span><span class="nx">pgmDB</span><span class="p">)</span> <span class="o">+</span>
        <span class="nx">ImpOpen</span><span class="p">(</span><span class="o">*</span><span class="nx">No</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>ASNA DataGate print file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">DclPrintFile</span> <span class="nx">MyPrint</span> <span class="o">+</span>
                 <span class="nx">DB</span><span class="p">(</span><span class="nx">prntDB</span><span class="p">)</span> <span class="o">+</span>
                 <span class="nx">File</span><span class="p">(</span><span class="s2">&quot;Examples/CustList2&quot;</span><span class="p">)</span> <span class="o">+</span>
                 <span class="nx">ImpOpen</span><span class="p">(</span><span class="o">*</span><span class="nx">No</span><span class="p">)</span>

    <span class="kr">DclFld</span> <span class="nx">XmlFilePath</span>        <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span>
    <span class="kr">DclFld</span> <span class="nx">OutputFilePath</span>     <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span>
    <span class="kr">DclFld</span> <span class="nx">PDFValuesAvailable</span> <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Boolean</span><span class="p">)</span>
    <span class="kr">DclFld</span> <span class="nx">PrinterName</span>        <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h2>Constructors</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Use this constructor when you want to print to default printer.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegConstructor</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
    <span class="kr">EndConstructor</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Use this constructor when you want to printer to non-default printer.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegConstructor</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
        <span class="kr">DclSrParm</span> <span class="nx">PrinterName</span>  <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span>

        <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">PrinterName</span> <span class="o">=</span> <span class="nx">PrinterName</span>
    <span class="kr">EndConstructor</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Use this constructor to print to Amyuni PDF printer.
This constructor ensures the two paths exist.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegConstructor</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
        <span class="kr">DclSrParm</span> <span class="nx">XmlFilePath</span>     <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span>
        <span class="kr">DclSrParm</span> <span class="nx">OutputFilePath</span>  <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span>

        <span class="kr">If</span> <span class="p">(</span><span class="k">NOT</span> <span class="nx">Directory</span><span class="p">.</span><span class="nx">Exists</span><span class="p">(</span><span class="nx">XmlFilePath</span><span class="p">))</span>
            <span class="nx">Throw</span> <span class="o">*</span><span class="nx">New</span> <span class="nx">System</span><span class="p">.</span><span class="nx">ArgumentException</span><span class="p">(</span><span class="o">+</span>
                <span class="kc">String</span><span class="p">.</span><span class="nx">Format</span><span class="p">(</span><span class="s2">&quot;&#39;{0}&#39; as XmlFilePath for Amyuni doesn&#39;t exist&quot;</span><span class="p">,</span> <span class="nx">XmlFilePath</span><span class="p">))</span>
        <span class="kr">EndIf</span>

        <span class="kr">If</span> <span class="p">(</span><span class="k">NOT</span> <span class="nx">Directory</span><span class="p">.</span><span class="nx">Exists</span><span class="p">(</span><span class="nx">OutputFilePath</span><span class="p">))</span>
            <span class="nx">Throw</span> <span class="o">*</span><span class="nx">New</span> <span class="nx">System</span><span class="p">.</span><span class="nx">ArgumentException</span><span class="p">(</span><span class="o">+</span>
                <span class="kc">String</span><span class="p">.</span><span class="nx">Format</span><span class="p">(</span><span class="s2">&quot;&#39;{0}&#39; as OutputFilePath for Amyuni doesn&#39;t exist&quot;</span><span class="p">,</span> <span class="nx">OutputFilePath</span><span class="p">))</span>
        <span class="kr">EndIf</span>

        <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">XmlFilePath</span> <span class="o">=</span> <span class="nx">XmlFilePath</span>
        <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">OutputFilePath</span> <span class="o">=</span> <span class="nx">OutputFilePath</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Set PDFValuesAvialable to true. This value will later be
used to signal these paths have been set--they are
<em>absolutely</em> necessary for the Amyuni print driver.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">PDFValuesAvailable</span> <span class="o">=</span> <span class="o">*</span><span class="kc">True</span>
    <span class="kr">EndConstructor</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h2>Methods</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>This public method prints the report to the default printer or,
if the single string argument constructor was used, the printer specified.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">PrintReportToPrinter</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
        <span class="nx">PrintReport</span><span class="p">()</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>This routine is the top-level public method to call to
print a report to PDF. Using this routine requires the
path to the XML configuration file and the output path
for PDF files has been provided in the XmlFilePath and
OutputFilePath private class fields. Usually you'll
populate these values through a constructor.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegFunc</span> <span class="nx">PrintReportToPDF</span> <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
        <span class="kr">DclFld</span> <span class="nx">am</span>          <span class="kr">Type</span><span class="p">(</span><span class="nx">ASNA</span><span class="p">.</span><span class="nx">AmyUniPDF</span><span class="p">.</span><span class="nx">Manager</span><span class="p">)</span>
        <span class="kr">DclFld</span> <span class="nx">PDFFileName</span> <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">String</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>PDFValuesAvailable is true if the XMlFilePath and OutputFilePath
fields define valid paths. The ASNA.Amyuni.Manager class is
instanced passing the XmlFilePath and OutputFilePath and then the
driver is started with StartDriver()</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="kr">If</span> <span class="p">(</span><span class="k">NOT</span> <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">PDFValuesAvailable</span><span class="p">)</span>
            <span class="nx">Throw</span> <span class="o">*</span><span class="nx">New</span> <span class="nx">System</span><span class="p">.</span><span class="nx">InvalidOperationException</span><span class="p">(</span><span class="s2">&quot;State not set for Amyuni PDF printing&quot;</span><span class="p">)</span>
        <span class="kr">EndIf</span>

        <span class="nx">am</span> <span class="o">=</span> <span class="o">*</span><span class="nx">New</span> <span class="nx">ASNA</span><span class="p">.</span><span class="nx">AmyUniPDF</span><span class="p">.</span><span class="nx">Manager</span><span class="p">(</span><span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">XmlFilePath</span><span class="p">,</span> <span class="o">*</span><span class="nx">This</span><span class="p">.</span><span class="nx">OutputFilePath</span><span class="p">)</span>
        <span class="nx">am</span><span class="p">.</span><span class="nx">StartDriver</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>It is very important to set the DataGate print file (MyPrint in
this case) Printer and ReportName properties to the two DriverInfo
properties show.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">MyPrint</span><span class="p">.</span><span class="nx">Printer</span> <span class="o">=</span> <span class="nx">am</span><span class="p">.</span><span class="nx">DriverInfo</span><span class="p">.</span><span class="nx">PrinterName</span>
        <span class="nx">MyPrint</span><span class="p">.</span><span class="nx">ReportName</span> <span class="o">=</span> <span class="nx">am</span><span class="p">.</span><span class="nx">DriverInfo</span><span class="p">.</span><span class="nx">OutputFileName</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>The PrintReport() prints the report. This routine, and routines it
calls have no knowledge of the Amyuni PDF driver. Without the code
in place to redirect to the Amyuni PDF dirver, calling PrintReport()
would print to a real printer.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">PrintReport</span><span class="p">()</span>
        <span class="nx">PDFFileName</span> <span class="o">=</span> <span class="nx">am</span><span class="p">.</span><span class="nx">StopDriver</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Return the name of the PDF file created. This value is only the file name and
its extension. This does not include its full path. You have the path file in
the OutputFilePath field you need to reference the fully qualified name of
the PDF file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="kr">LeaveSr</span> <span class="nx">PDFFileName</span>
    <span class="kr">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>This routine prints a DataGate report. It is not aware of
what the target printer (or virtual printer) is.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">PrintReport</span>
        <span class="nx">OpenFiles</span><span class="p">()</span>
        <span class="nx">WriteReport</span><span class="p">()</span>
        <span class="nx">CloseFiles</span><span class="p">()</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Open the DB connections and files.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">OpenFiles</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>It's important to set these DataGate print file
properties when printing in an ASP.NET app.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">MyPrint</span><span class="p">.</span><span class="nx">Preview</span>    <span class="o">=</span> <span class="o">*</span><span class="kc">False</span>
        <span class="nx">MyPrint</span><span class="p">.</span><span class="nx">PrintSetup</span> <span class="o">=</span> <span class="o">*</span><span class="kc">False</span>

        <span class="kr">Connect</span> <span class="nx">pgmDB</span>
        <span class="kr">Connect</span> <span class="nx">prntDB</span>
        <span class="kr">Open</span>    <span class="nx">Cust</span>
        <span class="kr">Open</span>    <span class="nx">MyPrint</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Close the files and DB connections.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">CloseFiles</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
        <span class="kr">Close</span> <span class="nx">Cust</span>
        <span class="kr">Close</span> <span class="nx">MyPrint</span>
        <span class="kr">Disconnect</span> <span class="nx">pgmDB</span>
        <span class="kr">Disconnect</span> <span class="nx">prntDB</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Write the three sections of a standard report.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">WriteReport</span> <span class="nx">Access</span><span class="p">(</span><span class="o">*</span><span class="nx">Public</span><span class="p">)</span>
        <span class="nx">WriteHeading</span><span class="p">()</span>
        <span class="nx">WriteBody</span><span class="p">()</span>
        <span class="nx">WriteFooter</span><span class="p">()</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Write the report heading.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">WriteHeading</span>
        <span class="kr">Write</span> <span class="nx">Heading</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Write the report body.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">WriteBody</span>
        <span class="kr">DclFld</span> <span class="nx">FooterMarginInInches</span> <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">Packed</span><span class="p">)</span> <span class="kr">Len</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="kr">DclFld</span> <span class="nx">FooterPrintUnits</span>     <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">Integer4</span><span class="p">)</span>

        <span class="nx">FooterMarginInInches</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span>
        <span class="nx">FooterPrintUnits</span> <span class="o">=</span> <span class="nx">ConvertInchesToPrintUnits</span><span class="p">(</span><span class="nx">FooterMarginInInches</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p><code>Do FromVal(1) ToVal(62)</code> is for testing purposes to ensure
this class prints enough rows to test overflow. For production
work, change this to:
<code>DoWhile (NOT Cust.IsEof)</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="kr">Do</span> <span class="nx">FromVal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="nx">ToVal</span><span class="p">(</span><span class="mi">62</span><span class="p">)</span>
            <span class="nx">CustomerName</span> <span class="o">=</span> <span class="nx">Cust_CMName</span>
            <span class="kr">Write</span> <span class="nx">Detail</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Check to see if overflow has been reached. If so
write the foot and the heading again.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="kr">If</span> <span class="p">(</span><span class="nx">FooterPrintUnits</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">AND</span> <span class="o">+</span>
               <span class="p">(</span><span class="nx">MyPrint</span><span class="p">.</span><span class="nx">FooterSize</span> <span class="o">&lt;=</span> <span class="nx">FooterPrintUnits</span><span class="p">)</span> <span class="k">OR</span> <span class="o">+</span>
               <span class="p">(</span><span class="nx">MyPrint</span><span class="p">.</span><span class="nx">InOverflow</span><span class="p">)</span>
                <span class="nx">WriteFooter</span><span class="p">()</span>
                <span class="nx">WriteHeading</span><span class="p">()</span>
            <span class="kr">EndIf</span>

            <span class="kr">Read</span> <span class="nx">Cust</span>
        <span class="kr">EndDo</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Write the report footer.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegSr</span> <span class="nx">WriteFooter</span>
        <span class="kr">Write</span> <span class="nx">Footer</span>
    <span class="kr">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>DataGate print files print units are used to track
where on the page the current line being printed is.
This routine converts printer units to inches.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kr">BegFunc</span> <span class="nx">ConvertInchesToPrintUnits</span> <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">Integer4</span><span class="p">)</span>
        <span class="kr">DclSrParm</span> <span class="nx">Inches</span> <span class="kr">Type</span><span class="p">(</span><span class="o">*</span><span class="kc">Packed</span><span class="p">)</span> <span class="kr">Len</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="kr">LeaveSr</span> <span class="nx">Inches</span> <span class="o">*</span> <span class="mi">254</span>
    <span class="kr">EndFunc</span>

<span class="kr">EndClass</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
